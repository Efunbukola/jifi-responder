<!-- 🚨 Incident Popup -->
<div
  *ngIf="showIncidentPopup"
  class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm z-10"
>
  <div class="bg-white rounded-lg shadow-xl w-11/12 max-w-sm p-6 text-center relative">
    <h2 class="text-lg font-semibold text-gray-800 mb-2">🚨 New Incident Alert</h2>

    <!-- Description -->
    <p class="text-sm text-gray-600 mb-3">
      {{ incomingIncident?.description }}
    </p>

    <!-- Photos section -->
    <div *ngIf="incomingIncident?.photos?.length" class="mb-3">
      <h3 class="text-sm font-semibold text-gray-700 mb-2">📸 Attached Photos</h3>
      <div class="flex flex-wrap justify-center gap-2">
        <img
          *ngFor="let photo of incomingIncident.photos"
          [src]="photo"
          (click)="openPhoto(photo)"
          alt="Incident photo"
          class="w-20 h-20 object-cover rounded-md cursor-pointer hover:scale-105 transition-transform"
        />
      </div>
    </div>

    <!-- Coordinates -->
    <div *ngIf="incomingIncident?.location" class="text-sm text-gray-500 mb-3">
      <p>
        📍 <b>Lat:</b>
        {{ incomingIncident.location.coordinates[1] | number: '1.5-5' }},
        <b>Lng:</b>
        {{ incomingIncident.location.coordinates[0] | number: '1.5-5' }}
      </p>
      <button
        (click)="openInMaps(
          incomingIncident.location.coordinates[1],
          incomingIncident.location.coordinates[0]
        )"
        class="mt-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-md text-sm"
      >
        View on Map
      </button>
    </div>

    <!-- Buttons -->
    <div class="flex justify-center space-x-4 mt-4">
      <button
        (click)="acceptIncident()"
        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md font-medium"
      >
        Accept
      </button>
      <button
        (click)="declineIncident()"
        class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md font-medium"
      >
        Decline
      </button>
    </div>

    <!-- Close icon (optional) -->
    <button
      (click)="declineIncident()"
      class="absolute top-2 right-3 text-gray-400 hover:text-gray-600"
    >
      ✕
    </button>
  </div>
</div>
